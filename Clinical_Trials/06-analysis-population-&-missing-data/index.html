
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Rahul">
      
      
        <link rel="canonical" href="https://rahulbalwan.github.io/BioStatRx/Clinical_Trials/06-analysis-population-%26-missing-data/">
      
      
        <link rel="prev" href="../05-sample-size-%26-power/">
      
      
        <link rel="next" href="../07-safety-analysis-adverse-events/">
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Analysis Population & Missing Data - BioStatRx</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#analysis-populations-itt-per-protocol-as-treated-missing-data" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="BioStatRx" class="md-header__button md-logo" aria-label="BioStatRx" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            BioStatRx
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Analysis Population & Missing Data
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="BioStatRx" class="md-nav__button md-logo" aria-label="BioStatRx" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    BioStatRx
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
        
        
      
    
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Foundations
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Foundations
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../Probability_Statistics/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    Probability & Statistics Review
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../Regression/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    Regression
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../Survival_Analysis/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    Survival Analysis
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Advanced Topics
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Advanced Topics
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Clinical Trials
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Clinical Trials
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../01-clinical-trials-foundations-%26-phases/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Foundations & Phases
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../02-randomization-%26-allocation-concealment/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Randomization & Allocation Concealment
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../03-trial-designs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Trial Designs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../04-outcomes-endpoints-%26-estimands/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Outcomes, Endpoints & Estimands
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../05-sample-size-%26-power/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Sample Size & Power
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Analysis Population & Missing Data
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Analysis Population & Missing Data
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-why-analysis-populations-matter" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Why analysis populations matter
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-intention-to-treat-itt" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Intention-to-treat (ITT)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. Intention-to-treat (ITT)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-definition" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.1 Definition
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-why-itt-is-the-default-primary-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.2 Why ITT is the default primary analysis
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23-itt-does-not-mean-ignore-missing-data" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.3 ITT does not mean “ignore missing data”
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-per-protocol-pp" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. Per-protocol (PP)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. Per-protocol (PP)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-definition" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.1 Definition
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-what-pp-estimates" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.2 What PP estimates
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-the-main-danger-selection-bias" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.3 The main danger: selection bias
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-as-treated-at" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. As-treated (AT)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. As-treated (AT)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-definition" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.1 Definition
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-when-at-is-used" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.2 When AT is used
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-a-practical-trial-workflow-itt-primary-sensitivity-analyses" class="md-nav__link">
    <span class="md-ellipsis">
      
        5. A practical trial workflow: ITT primary + sensitivity analyses
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-missing-data" class="md-nav__link">
    <span class="md-ellipsis">
      
        6. Missing data
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-missing-data-mechanisms" class="md-nav__link">
    <span class="md-ellipsis">
      
        7. Missing data mechanisms
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="7. Missing data mechanisms">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#71-mcar-missing-completely-at-random" class="md-nav__link">
    <span class="md-ellipsis">
      
        7.1 MCAR: Missing Completely At Random
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#72-mar-missing-at-random" class="md-nav__link">
    <span class="md-ellipsis">
      
        7.2 MAR: Missing At Random
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#73-mnar-missing-not-at-random" class="md-nav__link">
    <span class="md-ellipsis">
      
        7.3 MNAR: Missing Not At Random
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8-common-missing-data-approaches-in-trials" class="md-nav__link">
    <span class="md-ellipsis">
      
        8. Common missing-data approaches in trials
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="8. Common missing-data approaches in trials">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#81-complete-case-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      
        8.1 Complete-case analysis
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#82-single-imputation" class="md-nav__link">
    <span class="md-ellipsis">
      
        8.2 Single imputation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#83-multiple-imputation-mi" class="md-nav__link">
    <span class="md-ellipsis">
      
        8.3 Multiple imputation (MI)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#84-model-based-likelihood-methods-eg-mixed-models" class="md-nav__link">
    <span class="md-ellipsis">
      
        8.4 Model-based likelihood methods (e.g., mixed models)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../07-safety-analysis-adverse-events/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Safety Analysis & Adverse Events
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../08-reporting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Reporting & Interpretation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../Bayesian_Statistics/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    Bayesian Statistics
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../Infectious_Disease_Modelling/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    Infectious Disease Modelling
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../Machine_Learning/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    Machine Learning
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../Meta_Analysis/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    Meta Analysis
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../Reproducible_Research/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    Reproducible Research
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-why-analysis-populations-matter" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Why analysis populations matter
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-intention-to-treat-itt" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Intention-to-treat (ITT)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. Intention-to-treat (ITT)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-definition" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.1 Definition
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-why-itt-is-the-default-primary-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.2 Why ITT is the default primary analysis
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23-itt-does-not-mean-ignore-missing-data" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.3 ITT does not mean “ignore missing data”
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-per-protocol-pp" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. Per-protocol (PP)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. Per-protocol (PP)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-definition" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.1 Definition
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-what-pp-estimates" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.2 What PP estimates
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-the-main-danger-selection-bias" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.3 The main danger: selection bias
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-as-treated-at" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. As-treated (AT)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. As-treated (AT)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-definition" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.1 Definition
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-when-at-is-used" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.2 When AT is used
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-a-practical-trial-workflow-itt-primary-sensitivity-analyses" class="md-nav__link">
    <span class="md-ellipsis">
      
        5. A practical trial workflow: ITT primary + sensitivity analyses
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-missing-data" class="md-nav__link">
    <span class="md-ellipsis">
      
        6. Missing data
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-missing-data-mechanisms" class="md-nav__link">
    <span class="md-ellipsis">
      
        7. Missing data mechanisms
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="7. Missing data mechanisms">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#71-mcar-missing-completely-at-random" class="md-nav__link">
    <span class="md-ellipsis">
      
        7.1 MCAR: Missing Completely At Random
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#72-mar-missing-at-random" class="md-nav__link">
    <span class="md-ellipsis">
      
        7.2 MAR: Missing At Random
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#73-mnar-missing-not-at-random" class="md-nav__link">
    <span class="md-ellipsis">
      
        7.3 MNAR: Missing Not At Random
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8-common-missing-data-approaches-in-trials" class="md-nav__link">
    <span class="md-ellipsis">
      
        8. Common missing-data approaches in trials
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="8. Common missing-data approaches in trials">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#81-complete-case-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      
        8.1 Complete-case analysis
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#82-single-imputation" class="md-nav__link">
    <span class="md-ellipsis">
      
        8.2 Single imputation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#83-multiple-imputation-mi" class="md-nav__link">
    <span class="md-ellipsis">
      
        8.3 Multiple imputation (MI)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#84-model-based-likelihood-methods-eg-mixed-models" class="md-nav__link">
    <span class="md-ellipsis">
      
        8.4 Model-based likelihood methods (e.g., mixed models)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="analysis-populations-itt-per-protocol-as-treated-missing-data">Analysis Populations (ITT, Per-Protocol, As-Treated) + Missing Data<a class="headerlink" href="#analysis-populations-itt-per-protocol-as-treated-missing-data" title="Permanent link">&para;</a></h1>
<p>A trial’s design starts with randomization, but the credibility of results often depends on how we define:</p>
<ul>
<li><em>Who is included in the analysis?</em>  </li>
<li><em>How do we handle missing outcomes and protocol deviations?</em></li>
</ul>
<p>This chapter covers the most important analysis populations:
- <strong>Intention-to-treat (ITT)</strong>
- <strong>Per-protocol (PP)</strong>
- <strong>As-treated (AT)</strong></p>
<p>and provides practical strategies for handling missing data:
- complete-case (when acceptable and when not)
- multiple imputation (MI)
- model-based approaches (likelihood / mixed models concept)</p>
<p>We focus on biostatistical thinking:
- what estimand each approach answers
- what biases can enter
- what to report in a paper/SAP</p>
<hr />
<h2 id="1-why-analysis-populations-matter">1. Why analysis populations matter<a class="headerlink" href="#1-why-analysis-populations-matter" title="Permanent link">&para;</a></h2>
<p>Trials rarely run perfectly:
- participants discontinue treatment
- participants cross over or switch therapies
- outcomes are missing due to dropout or missed visits
- protocol deviations occur</p>
<p>How you define the analysis population determines:
- whether randomization is preserved
- what causal question is being answered
- whether results are biased</p>
<hr />
<h2 id="2-intention-to-treat-itt">2. Intention-to-treat (ITT)<a class="headerlink" href="#2-intention-to-treat-itt" title="Permanent link">&para;</a></h2>
<h3 id="21-definition">2.1 Definition<a class="headerlink" href="#21-definition" title="Permanent link">&para;</a></h3>
<p>In the ITT principle, you analyze participants <strong>as randomized</strong>, regardless of:
- adherence
- switching
- dropout (in principle; missingness still needs handling)</p>
<p>Population:
- usually “all randomized participants” (sometimes called “full analysis set”)</p>
<h3 id="22-why-itt-is-the-default-primary-analysis">2.2 Why ITT is the default primary analysis<a class="headerlink" href="#22-why-itt-is-the-default-primary-analysis" title="Permanent link">&para;</a></h3>
<ul>
<li>preserves the benefits of randomization</li>
<li>estimates the effect of “treatment policy”:</li>
<li>assigning the treatment in practice</li>
<li>including real-world non-adherence</li>
</ul>
<p>Interpretation:</p>
<blockquote>
<p>What happens if we assign patients to this treatment strategy in clinical practice?</p>
</blockquote>
<h3 id="23-itt-does-not-mean-ignore-missing-data">2.3 ITT does not mean “ignore missing data”<a class="headerlink" href="#23-itt-does-not-mean-ignore-missing-data" title="Permanent link">&para;</a></h3>
<p>A common misconception:
- ITT is not “analyze only those with observed outcomes”
- missingness must be addressed appropriately</p>
<hr />
<h2 id="3-per-protocol-pp">3. Per-protocol (PP)<a class="headerlink" href="#3-per-protocol-pp" title="Permanent link">&para;</a></h2>
<h3 id="31-definition">3.1 Definition<a class="headerlink" href="#31-definition" title="Permanent link">&para;</a></h3>
<p>Per-protocol analysis includes only participants who:
- adhered sufficiently to the protocol
- had no major protocol deviations
- met key eligibility criteria
- received adequate exposure</p>
<p>Different trials define PP differently, so PP must be clearly specified.</p>
<h3 id="32-what-pp-estimates">3.2 What PP estimates<a class="headerlink" href="#32-what-pp-estimates" title="Permanent link">&para;</a></h3>
<p>PP aims to estimate the effect of treatment <strong>under perfect adherence</strong>.</p>
<p>Interpretation:</p>
<blockquote>
<p>What would the treatment effect be if everyone adhered as intended?</p>
</blockquote>
<h3 id="33-the-main-danger-selection-bias">3.3 The main danger: selection bias<a class="headerlink" href="#33-the-main-danger-selection-bias" title="Permanent link">&para;</a></h3>
<p>Once you exclude participants post-randomization based on adherence or deviations, groups may no longer be comparable.</p>
<p>Adherence can relate to prognosis:
- sicker participants may discontinue more
- adverse events may cause discontinuation</p>
<p>So PP can be biased unless handled carefully.</p>
<p>PP is usually a sensitivity analysis, not primary.</p>
<hr />
<h2 id="4-as-treated-at">4. As-treated (AT)<a class="headerlink" href="#4-as-treated-at" title="Permanent link">&para;</a></h2>
<h3 id="41-definition">4.1 Definition<a class="headerlink" href="#41-definition" title="Permanent link">&para;</a></h3>
<p>Participants are analyzed according to what they actually received, not what they were randomized to.</p>
<p>This is closer to observational analysis:
- randomization is partially lost if switching occurs</p>
<p>Interpretation:</p>
<blockquote>
<p>Effect of receiving treatment, rather than being assigned treatment.</p>
</blockquote>
<h3 id="42-when-at-is-used">4.2 When AT is used<a class="headerlink" href="#42-when-at-is-used" title="Permanent link">&para;</a></h3>
<p>Often used as:
- secondary analysis
- safety analysis
- exploratory analysis</p>
<p>Main risk:
- confounding due to post-randomization switching</p>
<hr />
<h2 id="5-a-practical-trial-workflow-itt-primary-sensitivity-analyses">5. A practical trial workflow: ITT primary + sensitivity analyses<a class="headerlink" href="#5-a-practical-trial-workflow-itt-primary-sensitivity-analyses" title="Permanent link">&para;</a></h2>
<p>A common robust plan is:</p>
<p>Primary:
- ITT analysis, aligned with the primary estimand</p>
<p>Sensitivity:
- PP analysis (carefully defined)
- hypothetical estimand approaches (if relevant)
- alternative missing data assumptions</p>
<p>This allows readers and regulators to evaluate robustness.</p>
<hr />
<h2 id="6-missing-data">6. Missing data<a class="headerlink" href="#6-missing-data" title="Permanent link">&para;</a></h2>
<p>Missing outcomes occur due to:
- dropout
- missed visits
- withdrawal
- administrative censoring
- death (sometimes a competing event rather than “missing”)</p>
<p>Before choosing methods, understand <em>why</em> data are missing.</p>
<hr />
<h2 id="7-missing-data-mechanisms">7. Missing data mechanisms<a class="headerlink" href="#7-missing-data-mechanisms" title="Permanent link">&para;</a></h2>
<h3 id="71-mcar-missing-completely-at-random">7.1 MCAR: Missing Completely At Random<a class="headerlink" href="#71-mcar-missing-completely-at-random" title="Permanent link">&para;</a></h3>
<p>Missingness does not depend on observed or unobserved data.</p>
<p>Example:
- lab machine failure on random days</p>
<p>If MCAR holds, complete-case analysis can be unbiased (but still loses power).</p>
<h3 id="72-mar-missing-at-random">7.2 MAR: Missing At Random<a class="headerlink" href="#72-mar-missing-at-random" title="Permanent link">&para;</a></h3>
<p>Missingness may depend on observed data, but not on unobserved outcomes after conditioning.</p>
<p>Example:
- older participants miss visits more, but age is recorded</p>
<p>Many standard methods (MI, likelihood) assume MAR.</p>
<h3 id="73-mnar-missing-not-at-random">7.3 MNAR: Missing Not At Random<a class="headerlink" href="#73-mnar-missing-not-at-random" title="Permanent link">&para;</a></h3>
<p>Missingness depends on unobserved outcomes even after conditioning on observed data.</p>
<p>Example:
- participants with worsening symptoms are more likely to drop out, and worsening is not fully captured by observed variables</p>
<p>MNAR requires sensitivity analyses; it cannot be “fixed” by standard MI without assumptions.</p>
<hr />
<h2 id="8-common-missing-data-approaches-in-trials">8. Common missing-data approaches in trials<a class="headerlink" href="#8-common-missing-data-approaches-in-trials" title="Permanent link">&para;</a></h2>
<h3 id="81-complete-case-analysis">8.1 Complete-case analysis<a class="headerlink" href="#81-complete-case-analysis" title="Permanent link">&para;</a></h3>
<p>Analyze only participants with observed outcomes.</p>
<p>Pros:
- simple</p>
<p>Cons:
- biased if missingness is related to outcomes (common in trials)
- reduces power</p>
<p>Acceptable only under strong conditions (rare).</p>
<h3 id="82-single-imputation">8.2 Single imputation<a class="headerlink" href="#82-single-imputation" title="Permanent link">&para;</a></h3>
<p>Examples:
- last observation carried forward (LOCF)
- baseline carried forward
- mean imputation</p>
<p>Problems:
- can bias treatment effect
- underestimates uncertainty
- LOCF makes strong assumptions about disease trajectory</p>
<p>Usually not recommended as primary for modern trials.</p>
<h3 id="83-multiple-imputation-mi">8.3 Multiple imputation (MI)<a class="headerlink" href="#83-multiple-imputation-mi" title="Permanent link">&para;</a></h3>
<p>MI fills in missing values multiple times to create several completed datasets.<br />
Each dataset is analyzed, then results are combined (Rubin’s rules).</p>
<p>Key advantages:
- accounts for uncertainty in imputation
- flexible for many outcome types
- widely accepted if assumptions are justified</p>
<h3 id="84-model-based-likelihood-methods-eg-mixed-models">8.4 Model-based likelihood methods (e.g., mixed models)<a class="headerlink" href="#84-model-based-likelihood-methods-eg-mixed-models" title="Permanent link">&para;</a></h3>
<p>For repeated continuous outcomes, mixed models (MMRM) can provide valid inference under MAR without explicit imputation.</p>
<p>These are common in longitudinal clinical trials.</p>
<hr />
<h1 id="part-a-practical-demonstration-in-python">Part A — Practical demonstration in Python<a class="headerlink" href="#part-a-practical-demonstration-in-python" title="Permanent link">&para;</a></h1>
<p>Python has strong imputation tools; full Rubin’s-rule MI for regression is less standard than in R,
but we can still demonstrate correct workflow and make the logic clear.</p>
<hr />
<h2 id="9a-python-simulate-a-trial-dataset-with-dropout">9A. Python: Simulate a trial dataset with dropout<a class="headerlink" href="#9a-python-simulate-a-trial-dataset-with-dropout" title="Permanent link">&para;</a></h2>
<p>We simulate:
- baseline severity
- treatment effect
- dropout that depends on worsening (MAR/MNAR-like depending on variables included)</p>
<div class="admonition interactive">
<p class="admonition-title">Python</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">trt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">binomial</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

<span class="n">severity0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="c1"># true treatment effect on outcome</span>
<span class="n">true_delta</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span>
<span class="n">noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

<span class="c1"># continuous outcome at follow-up</span>
<span class="n">y</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">*</span><span class="n">severity0</span> <span class="o">+</span> <span class="n">true_delta</span><span class="o">*</span><span class="n">trt</span> <span class="o">+</span> <span class="n">noise</span>

<span class="c1"># dropout probability depends on outcome (worse outcomes more likely to drop)</span>
<span class="c1"># we don&#39;t observe y if dropped -&gt; MNAR-ish in truth</span>
<span class="n">p_drop</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.8</span><span class="o">*</span><span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)))</span>
<span class="n">drop</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">binomial</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">p_drop</span><span class="p">)</span>

<span class="n">y_obs</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">y_obs</span><span class="p">[</span><span class="n">drop</span><span class="o">==</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;trt&quot;</span><span class="p">:</span> <span class="n">trt</span><span class="p">,</span> <span class="s2">&quot;severity0&quot;</span><span class="p">:</span> <span class="n">severity0</span><span class="p">,</span> <span class="s2">&quot;y_true&quot;</span><span class="p">:</span> <span class="n">y</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="n">y_obs</span><span class="p">,</span> <span class="s2">&quot;drop&quot;</span><span class="p">:</span> <span class="n">drop</span><span class="p">})</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div>
</div>
<p>Check missingness rate by group:</p>
<div class="admonition interactive">
<p class="admonition-title">Python</p>
<div class="highlight"><pre><span></span><code><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;trt&quot;</span><span class="p">)[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</code></pre></div>
</div>
<hr />
<h2 id="10a-python-itt-naive-complete-case-estimate-often-biased">10A. Python: ITT naive complete-case estimate (often biased)<a class="headerlink" href="#10a-python-itt-naive-complete-case-estimate-often-biased" title="Permanent link">&para;</a></h2>
<div class="admonition interactive">
<p class="admonition-title">Python</p>
<div class="highlight"><pre><span></span><code><span class="n">cc</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">])</span>
<span class="n">est_cc</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">cc</span><span class="o">.</span><span class="n">trt</span><span class="o">==</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">-</span> <span class="n">cc</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">cc</span><span class="o">.</span><span class="n">trt</span><span class="o">==</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">est_cc</span>
</code></pre></div>
</div>
<p>Compare to the true ITT difference using the latent true outcome:</p>
<div class="admonition interactive">
<p class="admonition-title">Python</p>
<div class="highlight"><pre><span></span><code><span class="n">true_itt</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">trt</span><span class="o">==</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;y_true&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">-</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">trt</span><span class="o">==</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;y_true&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">true_itt</span>
</code></pre></div>
</div>
<p>If missingness is related to outcome, complete-case can distort the effect.</p>
<hr />
<h2 id="11a-python-simple-imputation-mean-imputation-shown-only-to-demonstrate-why-its-weak">11A. Python: Simple imputation (mean imputation) — shown only to demonstrate why it’s weak<a class="headerlink" href="#11a-python-simple-imputation-mean-imputation-shown-only-to-demonstrate-why-its-weak" title="Permanent link">&para;</a></h2>
<div class="admonition interactive">
<p class="admonition-title">Python</p>
<div class="highlight"><pre><span></span><code><span class="n">df_meanimp</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df_meanimp</span><span class="p">[</span><span class="s2">&quot;y_imp&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_meanimp</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">df_meanimp</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>

<span class="n">est_meanimp</span> <span class="o">=</span> <span class="n">df_meanimp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_meanimp</span><span class="o">.</span><span class="n">trt</span><span class="o">==</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;y_imp&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">-</span> <span class="n">df_meanimp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_meanimp</span><span class="o">.</span><span class="n">trt</span><span class="o">==</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;y_imp&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">est_meanimp</span>
</code></pre></div>
</div>
<p>Mean imputation can bias effect and understate uncertainty.</p>
<hr />
<h2 id="12a-python-imputation-using-observed-covariates-mi-style-workflow">12A. Python: Imputation using observed covariates (MI-style workflow)<a class="headerlink" href="#12a-python-imputation-using-observed-covariates-mi-style-workflow" title="Permanent link">&para;</a></h2>
<p>We do a principled imputation using baseline severity and treatment as predictors.</p>
<p>This is not full Rubin’s-rule MI, but it shows the essential idea:
- use observed data to predict missing outcomes</p>
<div class="admonition interactive">
<p class="admonition-title">Python</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">statsmodels.api</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sm</span>

<span class="n">df_imp</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># Fit a regression model on observed cases</span>
<span class="n">obs</span> <span class="o">=</span> <span class="n">df_imp</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">])</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">obs</span><span class="p">[[</span><span class="s2">&quot;trt&quot;</span><span class="p">,</span> <span class="s2">&quot;severity0&quot;</span><span class="p">]])</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">OLS</span><span class="p">(</span><span class="n">obs</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">],</span> <span class="n">X</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

<span class="c1"># Predict missing y and add random noise based on residual SD (one stochastic imputation)</span>
<span class="n">miss</span> <span class="o">=</span> <span class="n">df_imp</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span>
<span class="n">Xmiss</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">df_imp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">miss</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;trt&quot;</span><span class="p">,</span> <span class="s2">&quot;severity0&quot;</span><span class="p">]])</span>

<span class="n">resid_sd</span> <span class="o">=</span> <span class="n">obs</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">))</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">Xmiss</span><span class="p">)</span>
<span class="n">df_imp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">miss</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_pred</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">resid_sd</span><span class="p">,</span> <span class="n">miss</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>

<span class="c1"># ITT estimate after imputation</span>
<span class="n">est_imp</span> <span class="o">=</span> <span class="n">df_imp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_imp</span><span class="o">.</span><span class="n">trt</span><span class="o">==</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">-</span> <span class="n">df_imp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_imp</span><span class="o">.</span><span class="n">trt</span><span class="o">==</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">est_imp</span>
</code></pre></div>
</div>
<p>In real MI:
- repeat this M times
- analyze each dataset
- pool estimates + SE via Rubin’s rules
R makes this easier and is standard for clinical trials.</p>
<hr />
<h1 id="part-b-practical-multiple-imputation-in-r-recommended-for-trials">Part B — Practical multiple imputation in R (recommended for trials)<a class="headerlink" href="#part-b-practical-multiple-imputation-in-r-recommended-for-trials" title="Permanent link">&para;</a></h1>
<p>We show MI using the <code>mice</code> package.</p>
<hr />
<h2 id="13b-r-simulate-trial-with-dropout">13B. R: Simulate trial with dropout<a class="headerlink" href="#13b-r-simulate-trial-with-dropout" title="Permanent link">&para;</a></h2>
<div class="admonition interactive">
<p class="admonition-title">R</p>
<div class="highlight"><pre><span></span><code><span class="nf">set.seed</span><span class="p">(</span><span class="m">123</span><span class="p">)</span>

<span class="n">n</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">500</span>
<span class="n">trt</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rbinom</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">0.5</span><span class="p">)</span>
<span class="n">severity0</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rnorm</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">)</span>

<span class="n">true_delta</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">-0.5</span>
<span class="n">noise</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rnorm</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">)</span>

<span class="n">y_true</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">1.0</span><span class="o">*</span><span class="n">severity0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">true_delta</span><span class="o">*</span><span class="n">trt</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">noise</span>

<span class="n">p_drop</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="m">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="m">-0.8</span><span class="o">*</span><span class="p">(</span><span class="n">y_true</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">0.5</span><span class="p">)))</span>
<span class="n">drop</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rbinom</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">p_drop</span><span class="p">)</span>

<span class="n">y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">y_true</span>
<span class="n">y</span><span class="p">[</span><span class="n">drop</span><span class="o">==</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kc">NA</span>

<span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span><span class="n">trt</span><span class="o">=</span><span class="n">trt</span><span class="p">,</span><span class="w"> </span><span class="n">severity0</span><span class="o">=</span><span class="n">severity0</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">drop</span><span class="o">=</span><span class="n">drop</span><span class="p">,</span><span class="w"> </span><span class="n">y_true</span><span class="o">=</span><span class="n">y_true</span><span class="p">)</span>
<span class="nf">head</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</code></pre></div>
</div>
<p>Missingness rate:</p>
<div class="admonition interactive">
<p class="admonition-title">R</p>
<div class="highlight"><pre><span></span><code><span class="nf">tapply</span><span class="p">(</span><span class="nf">is.na</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">y</span><span class="p">),</span><span class="w"> </span><span class="n">df</span><span class="o">$</span><span class="n">trt</span><span class="p">,</span><span class="w"> </span><span class="n">mean</span><span class="p">)</span>
</code></pre></div>
</div>
<hr />
<h2 id="14b-r-complete-case-itt-estimate-naive">14B. R: Complete-case ITT estimate (naive)<a class="headerlink" href="#14b-r-complete-case-itt-estimate-naive" title="Permanent link">&para;</a></h2>
<div class="admonition interactive">
<p class="admonition-title">R</p>
<div class="highlight"><pre><span></span><code><span class="n">cc</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df</span><span class="p">[</span><span class="o">!</span><span class="nf">is.na</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">y</span><span class="p">),</span><span class="w"> </span><span class="p">]</span>
<span class="n">est_cc</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">cc</span><span class="o">$</span><span class="n">y</span><span class="p">[</span><span class="n">cc</span><span class="o">$</span><span class="n">trt</span><span class="o">==</span><span class="m">1</span><span class="p">])</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">cc</span><span class="o">$</span><span class="n">y</span><span class="p">[</span><span class="n">cc</span><span class="o">$</span><span class="n">trt</span><span class="o">==</span><span class="m">0</span><span class="p">])</span>
<span class="n">est_cc</span>
</code></pre></div>
</div>
<p>True ITT (latent):</p>
<div class="admonition interactive">
<p class="admonition-title">R</p>
<div class="highlight"><pre><span></span><code><span class="n">true_itt</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">y_true</span><span class="p">[</span><span class="n">df</span><span class="o">$</span><span class="n">trt</span><span class="o">==</span><span class="m">1</span><span class="p">])</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">y_true</span><span class="p">[</span><span class="n">df</span><span class="o">$</span><span class="n">trt</span><span class="o">==</span><span class="m">0</span><span class="p">])</span>
<span class="n">true_itt</span>
</code></pre></div>
</div>
<hr />
<h2 id="15b-r-multiple-imputation-using-mice">15B. R: Multiple imputation using mice<a class="headerlink" href="#15b-r-multiple-imputation-using-mice" title="Permanent link">&para;</a></h2>
<p>If you don't have it installed:
<code>install.packages("mice")</code></p>
<div class="admonition interactive">
<p class="admonition-title">R</p>
<div class="highlight"><pre><span></span><code><span class="nf">library</span><span class="p">(</span><span class="n">mice</span><span class="p">)</span>

<span class="c1"># Use predictors: trt and severity0</span>
<span class="n">imp</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">mice</span><span class="p">(</span><span class="n">df</span><span class="p">[,</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;trt&quot;</span><span class="p">,</span><span class="s">&quot;severity0&quot;</span><span class="p">,</span><span class="s">&quot;y&quot;</span><span class="p">)],</span><span class="w"> </span><span class="n">m</span><span class="o">=</span><span class="m">20</span><span class="p">,</span><span class="w"> </span><span class="n">seed</span><span class="o">=</span><span class="m">202</span><span class="p">,</span><span class="w"> </span><span class="n">printFlag</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span>

<span class="c1"># Fit the analysis model within each imputed dataset</span>
<span class="n">fit</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">with</span><span class="p">(</span><span class="n">imp</span><span class="p">,</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">trt</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">severity0</span><span class="p">))</span>

<span class="c1"># Pool results (Rubin&#39;s rules)</span>
<span class="n">pooled</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">pool</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">pooled</span><span class="p">)</span>
</code></pre></div>
</div>
<p>Interpretation:
- coefficient of <code>trt</code> is the adjusted treatment effect estimate
- MI accounts for uncertainty due to missingness under MAR assumptions (given included predictors)</p>
<hr />
<h2 id="16-sensitivity-analyses">16. Sensitivity analyses<a class="headerlink" href="#16-sensitivity-analyses" title="Permanent link">&para;</a></h2>
<p>Because missingness may be MNAR, trials often include sensitivity analyses such as:
- different imputation models
- pattern-mixture models (e.g., shift imputed values down/up)
- tipping-point analysis</p>
<p>A simple “delta adjustment” idea:
- after imputation, subtract a fixed amount from imputed outcomes in one group to represent worse-than-assumed outcomes</p>
<p>This is not a universal method, but it illustrates sensitivity thinking.</p>
<hr />
<h2 id="17-reporting-what-should-appear-in-a-trial-reportsap">17. Reporting: what should appear in a trial report/SAP<a class="headerlink" href="#17-reporting-what-should-appear-in-a-trial-reportsap" title="Permanent link">&para;</a></h2>
<p>For analysis populations:
- define ITT (full analysis set)
- define PP criteria explicitly
- specify handling of protocol deviations</p>
<p>For missing data:
- describe extent and reasons for missingness
- justify assumptions (MAR vs plausible MNAR)
- specify primary method (MI or likelihood)
- include sensitivity analyses</p>
<hr />
<h2 id="18-exercises">18. Exercises<a class="headerlink" href="#18-exercises" title="Permanent link">&para;</a></h2>
<details>
<summary>Click to try</summary>

1. Modify dropout so it depends on baseline severity only (more MAR-like). Compare CC vs MI estimates.  
2. In the R MI example, increase number of imputations from 20 to 50 and see if results stabilize.  
3. Create a PP dataset by excluding participants with severe baseline severity and compare ITT vs PP (note the bias risk).  
4. Simulate treatment switching (e.g., some control patients switch if outcome is high) and discuss whether ITT and AT differ.  
5. Write a short paragraph: which analysis population is primary and why?

</details>

<hr />
<h2 id="19-summary">19. Summary<a class="headerlink" href="#19-summary" title="Permanent link">&para;</a></h2>
<ul>
<li>ITT preserves randomization and is typically primary.</li>
<li>PP and as-treated analyses can be biased because they break randomization.</li>
<li>Missing data is not solved by simply dropping incomplete cases.</li>
<li>Multiple imputation and likelihood-based methods provide principled handling under MAR assumptions.</li>
<li>Sensitivity analyses are essential when MNAR is plausible.</li>
</ul>
<hr />












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.sections", "navigation.expand", "navigation.indexes", "navigation.prune", "navigation.top", "toc.follow", "search.highlight", "search.suggest"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>