
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Rahul">
      
      
        <link rel="canonical" href="https://rahulbalwan.github.io/BioStatRx/Clinical_Trials/02-randomization-%26-allocation-concealment/">
      
      
        <link rel="prev" href="../01-clinical-trials-foundations-%26-phases/">
      
      
        <link rel="next" href="../03-trial-designs/">
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Randomization & Allocation Concealment - BioStatRx</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#randomization-allocation-concealment" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="BioStatRx" class="md-header__button md-logo" aria-label="BioStatRx" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            BioStatRx
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Randomization & Allocation Concealment
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="BioStatRx" class="md-nav__button md-logo" aria-label="BioStatRx" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    BioStatRx
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
        
        
      
    
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Foundations
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Foundations
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../Probability_Statistics/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    Probability & Statistics Review
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../Regression/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    Regression
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../Survival_Analysis/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    Survival Analysis
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Advanced Topics
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Advanced Topics
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Clinical Trials
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Clinical Trials
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../01-clinical-trials-foundations-%26-phases/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Foundations & Phases
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Randomization & Allocation Concealment
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Randomization & Allocation Concealment
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-why-randomize" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Why randomize?
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1. Why randomize?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11-confounding-in-observational-treatment-comparisons" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.1 Confounding in observational treatment comparisons
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-what-randomization-accomplishes" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.2 What randomization accomplishes
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13-in-expectation-vs-in-any-single-trial" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.3 “In expectation” vs “in any single trial”
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-allocation-concealment-vs-blinding" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Allocation concealment vs blinding
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. Allocation concealment vs blinding">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-allocation-concealment" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.1 Allocation concealment
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-blinding" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.2 Blinding
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-randomization-methods" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. Randomization methods
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. Randomization methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-simple-randomization" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.1 Simple randomization
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-block-randomization" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.2 Block randomization
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-unequal-allocation-ratios-eg-21" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.3 Unequal allocation ratios (e.g., 2:1)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#34-stratified-randomization" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.4 Stratified randomization
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#35-minimization-covariate-adaptive-randomization" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.5 Minimization (covariate-adaptive randomization)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-baseline-balance-what-to-do-and-what-not-to-do" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. Baseline balance: what to do and what not to do
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. Baseline balance: what to do and what not to do">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-what-to-do" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.1 What to do
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-what-not-to-do-baseline-p-values" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.2 What not to do: baseline p-values
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../03-trial-designs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Trial Designs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../04-outcomes-endpoints-%26-estimands/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Outcomes, Endpoints & Estimands
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../05-sample-size-%26-power/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Sample Size & Power
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../06-analysis-population-%26-missing-data/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Analysis Population & Missing Data
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../07-safety-analysis-adverse-events/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Safety Analysis & Adverse Events
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../08-reporting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Reporting & Interpretation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../Bayesian_Statistics/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    Bayesian Statistics
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../Infectious_Disease_Modelling/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    Infectious Disease Modelling
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../Machine_Learning/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    Machine Learning
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../Meta_Analysis/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    Meta Analysis
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../Reproducible_Research/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    Reproducible Research
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-why-randomize" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Why randomize?
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1. Why randomize?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11-confounding-in-observational-treatment-comparisons" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.1 Confounding in observational treatment comparisons
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-what-randomization-accomplishes" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.2 What randomization accomplishes
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13-in-expectation-vs-in-any-single-trial" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.3 “In expectation” vs “in any single trial”
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-allocation-concealment-vs-blinding" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Allocation concealment vs blinding
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. Allocation concealment vs blinding">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-allocation-concealment" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.1 Allocation concealment
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-blinding" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.2 Blinding
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-randomization-methods" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. Randomization methods
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. Randomization methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-simple-randomization" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.1 Simple randomization
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-block-randomization" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.2 Block randomization
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-unequal-allocation-ratios-eg-21" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.3 Unequal allocation ratios (e.g., 2:1)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#34-stratified-randomization" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.4 Stratified randomization
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#35-minimization-covariate-adaptive-randomization" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.5 Minimization (covariate-adaptive randomization)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-baseline-balance-what-to-do-and-what-not-to-do" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. Baseline balance: what to do and what not to do
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. Baseline balance: what to do and what not to do">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-what-to-do" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.1 What to do
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-what-not-to-do-baseline-p-values" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.2 What not to do: baseline p-values
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="randomization-allocation-concealment">Randomization &amp; Allocation Concealment<a class="headerlink" href="#randomization-allocation-concealment" title="Permanent link">&para;</a></h1>
<p>Randomization is the design feature that makes a clinical trial fundamentally different from an observational study.<br />
It protects the treatment comparison from confounding and forms the basis for valid inference.</p>
<p>However, randomization only works as intended when it is paired with <strong>allocation concealment</strong> (to prevent selection bias) and, when feasible, <strong>blinding</strong> (to reduce performance and assessment bias).</p>
<p>This chapter explains the major randomization approaches used in clinical trials, the logic behind each, and how to implement them in both <strong>Python</strong> and <strong>R</strong>.</p>
<hr />
<h2 id="1-why-randomize">1. Why randomize?<a class="headerlink" href="#1-why-randomize" title="Permanent link">&para;</a></h2>
<h3 id="11-confounding-in-observational-treatment-comparisons">1.1 Confounding in observational treatment comparisons<a class="headerlink" href="#11-confounding-in-observational-treatment-comparisons" title="Permanent link">&para;</a></h3>
<p>In observational studies, treatment is often related to prognosis. For example, sicker patients might be more likely to receive an aggressive therapy. If we compare treated vs untreated outcomes, the comparison mixes:
- the effect of treatment
- the baseline differences in patients</p>
<p>This is the classic confounding problem.</p>
<h3 id="12-what-randomization-accomplishes">1.2 What randomization accomplishes<a class="headerlink" href="#12-what-randomization-accomplishes" title="Permanent link">&para;</a></h3>
<p>Randomization makes treatment assignment independent of baseline covariates <em>in expectation</em>.</p>
<p>This implies:
- groups are comparable on both measured and unmeasured prognostic factors on average
- differences in outcomes can be attributed to treatment (under the trial’s conditions)
- standard statistical inference (confidence intervals, p-values) is justified by the design</p>
<h3 id="13-in-expectation-vs-in-any-single-trial">1.3 “In expectation” vs “in any single trial”<a class="headerlink" href="#13-in-expectation-vs-in-any-single-trial" title="Permanent link">&para;</a></h3>
<p>Randomization guarantees balance <strong>on average</strong> across repeated trials. In any single realized trial, chance imbalances can occur, especially when sample size is small. This is normal and not evidence of trial failure.</p>
<hr />
<h2 id="2-allocation-concealment-vs-blinding">2. Allocation concealment vs blinding<a class="headerlink" href="#2-allocation-concealment-vs-blinding" title="Permanent link">&para;</a></h2>
<p>These two concepts are often confused. They address different biases.</p>
<h3 id="21-allocation-concealment">2.1 Allocation concealment<a class="headerlink" href="#21-allocation-concealment" title="Permanent link">&para;</a></h3>
<p>Allocation concealment means:
- the person enrolling participants cannot predict or influence the next assignment</p>
<p>It happens at the time of enrollment, before treatment is assigned.</p>
<p>If allocation is not concealed, investigators may unconsciously alter enrollment behavior:
- enrolling high-risk patients when they expect the better arm
- delaying enrollment when they expect the worse arm</p>
<p>This breaks comparability of groups.</p>
<p>Common concealment methods:
- centralized web/telephone randomization service
- pharmacy-controlled dispensing
- sequentially numbered, opaque, sealed envelopes (SNOSE) when done correctly</p>
<h3 id="22-blinding">2.2 Blinding<a class="headerlink" href="#22-blinding" title="Permanent link">&para;</a></h3>
<p>Blinding means:
- participants, clinicians, and/or outcome assessors do not know treatment assignment</p>
<p>It happens after assignment.</p>
<p>Blinding reduces bias from:
- differential co-interventions or care
- placebo and behavioral effects
- biased outcome assessment (especially for subjective outcomes)</p>
<p>You can have:
- concealed allocation without blinding
- blinding without proper concealment (rare but possible)
- both (ideal in many drug trials)</p>
<hr />
<h2 id="3-randomization-methods">3. Randomization methods<a class="headerlink" href="#3-randomization-methods" title="Permanent link">&para;</a></h2>
<h3 id="31-simple-randomization">3.1 Simple randomization<a class="headerlink" href="#31-simple-randomization" title="Permanent link">&para;</a></h3>
<p>Each participant is assigned independently using a fixed probability.</p>
<p>For 1:1 allocation:</p>
<div class="arithmatex">\[
P(\mathrm{Treatment}) = 0.5,\qquad P(\mathrm{Control}) = 0.5
\]</div>
<p>Pros:
- simplest
- strong unpredictability (good for concealment)</p>
<p>Cons:
- imbalance can occur in small trials (e.g., 14 vs 6 in a trial of n=20)
- imbalance within sites (multicenter trials) is possible</p>
<p>Best used in:
- large trials where imbalance is unlikely to be problematic
- settings where balance at interim time points is not crucial</p>
<hr />
<h3 id="32-block-randomization">3.2 Block randomization<a class="headerlink" href="#32-block-randomization" title="Permanent link">&para;</a></h3>
<p>Block randomization forces balance within small blocks.</p>
<p>Example: block size 4, 1:1 allocation<br />
Each block contains 2 treatment and 2 control assignments, in random order.</p>
<p>Pros:
- ensures near-perfect balance throughout enrollment
- useful in small/medium sample trials
- helpful when enrollment may stop early or when interim analyses occur</p>
<p>Cons:
- can become predictable if block size is fixed and known</p>
<p>Mitigation:
- use random block sizes (e.g., 4 and 6)
- keep block structure hidden (allocation concealment)</p>
<hr />
<h3 id="33-unequal-allocation-ratios-eg-21">3.3 Unequal allocation ratios (e.g., 2:1)<a class="headerlink" href="#33-unequal-allocation-ratios-eg-21" title="Permanent link">&para;</a></h3>
<p>Sometimes trials allocate more patients to treatment:
- more safety data on new therapy
- recruitment incentives (higher chance to get active drug)
- cost or ethical constraints</p>
<p>If ratio is Treatment:Control = 2:1, then within a block size 6:
- 4 treatment
- 2 control</p>
<p>Trade-off:
- power is maximized near 1:1 for fixed total n
- unequal allocation increases required sample size for same power</p>
<hr />
<h3 id="34-stratified-randomization">3.4 Stratified randomization<a class="headerlink" href="#34-stratified-randomization" title="Permanent link">&para;</a></h3>
<p>Stratified randomization aims to balance groups within levels of important variables (strata), typically using block randomization inside each stratum.</p>
<p>Common stratification factors:
- center/site in multicenter trials
- disease severity category
- sex
- prior treatment history</p>
<p>Pros:
- improves balance on strong prognostic variables
- useful when sample is moderate and imbalance would harm credibility</p>
<p>Cons:
- too many strata becomes unmanageable
- small strata might still be imbalanced due to sparse data</p>
<p>Practical guidance:
- stratify only on the most prognostic variables
- keep number of strata modest</p>
<hr />
<h3 id="35-minimization-covariate-adaptive-randomization">3.5 Minimization (covariate-adaptive randomization)<a class="headerlink" href="#35-minimization-covariate-adaptive-randomization" title="Permanent link">&para;</a></h3>
<p>Minimization assigns treatment based on current imbalance across multiple covariates. Many implementations include a random component.</p>
<p>Pros:
- can balance several covariates even with small samples
- useful when many baseline factors are critical</p>
<p>Cons:
- more complex to implement and audit
- requires careful documentation and concealment
- analysis often still uses standard ITT methods, but design must be described clearly</p>
<p>Minimization is often run via specialized randomization systems rather than simple scripts.</p>
<hr />
<h2 id="4-baseline-balance-what-to-do-and-what-not-to-do">4. Baseline balance: what to do and what not to do<a class="headerlink" href="#4-baseline-balance-what-to-do-and-what-not-to-do" title="Permanent link">&para;</a></h2>
<h3 id="41-what-to-do">4.1 What to do<a class="headerlink" href="#41-what-to-do" title="Permanent link">&para;</a></h3>
<ul>
<li>Provide a baseline characteristics table </li>
<li>Look for clinically meaningful imbalances</li>
<li>Pre-specify adjustment covariates</li>
</ul>
<h3 id="42-what-not-to-do-baseline-p-values">4.2 What not to do: baseline p-values<a class="headerlink" href="#42-what-not-to-do-baseline-p-values" title="Permanent link">&para;</a></h3>
<p>Testing baseline differences with p-values is widely discouraged because:
- under randomization, any imbalance is due to chance
- baseline p-values do not diagnose trial quality
- they encourage incorrect thinking about randomization</p>
<p>Instead:
- report descriptive summaries
- optionally report standardized differences </p>
<hr />
<h1 id="part-a-implementation-in-python">Part A — Implementation in Python<a class="headerlink" href="#part-a-implementation-in-python" title="Permanent link">&para;</a></h1>
<p>The goal here is to generate reproducible randomization lists that you can actually use in a study workflow.</p>
<p>We will show:
- simple randomization
- block randomization
- random block sizes
- stratified block randomization
- 2:1 allocation example
- quick checks for balance</p>
<hr />
<h2 id="5a-python-simple-randomization-11">5A. Python: Simple randomization (1:1)<a class="headerlink" href="#5a-python-simple-randomization-11" title="Permanent link">&para;</a></h2>
<div class="admonition interactive">
<p class="admonition-title">Python</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">40</span>
<span class="n">assignments</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="s2">&quot;Treatment&quot;</span><span class="p">,</span> <span class="s2">&quot;Control&quot;</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">])</span>

<span class="n">rand_list</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;participant_id&quot;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span>
    <span class="s2">&quot;assignment&quot;</span><span class="p">:</span> <span class="n">assignments</span>
<span class="p">})</span>

<span class="n">rand_list</span><span class="p">[</span><span class="s2">&quot;assignment&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</code></pre></div>
</div>
<hr />
<h2 id="6a-python-block-randomization-fixed-block-size-11">6A. Python: Block randomization (fixed block size, 1:1)<a class="headerlink" href="#6a-python-block-randomization-fixed-block-size-11" title="Permanent link">&para;</a></h2>
<div class="admonition interactive">
<p class="admonition-title">Python</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="k">def</span><span class="w"> </span><span class="nf">block_randomization</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">block_size</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">block_size</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;For 1:1 allocation, block_size must be even.&quot;</span><span class="p">)</span>
    <span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>

    <span class="n">assignments</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">assignments</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">:</span>
        <span class="n">block</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Treatment&quot;</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">block_size</span><span class="o">//</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;Control&quot;</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">block_size</span><span class="o">//</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">rng</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">block</span><span class="p">)</span>
        <span class="n">assignments</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">block</span><span class="p">)</span>

    <span class="n">assignments</span> <span class="o">=</span> <span class="n">assignments</span><span class="p">[:</span><span class="n">n</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;participant_id&quot;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="s2">&quot;assignment&quot;</span><span class="p">:</span> <span class="n">assignments</span><span class="p">})</span>

<span class="n">rand_block</span> <span class="o">=</span> <span class="n">block_randomization</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">block_size</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="n">rand_block</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
</code></pre></div>
</div>
<hr />
<h2 id="7a-python-random-block-sizes">7A. Python: Random block sizes<a class="headerlink" href="#7a-python-random-block-sizes" title="Permanent link">&para;</a></h2>
<div class="admonition interactive">
<p class="admonition-title">Python</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="k">def</span><span class="w"> </span><span class="nf">random_block_randomization</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">block_sizes</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="n">seed</span><span class="o">=</span><span class="mi">123</span><span class="p">):</span>
    <span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
    <span class="n">assignments</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">assignments</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">:</span>
        <span class="n">b</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">block_sizes</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">b</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="n">block</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Treatment&quot;</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">b</span><span class="o">//</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;Control&quot;</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">b</span><span class="o">//</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">rng</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">block</span><span class="p">)</span>
        <span class="n">assignments</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">block</span><span class="p">)</span>

    <span class="n">assignments</span> <span class="o">=</span> <span class="n">assignments</span><span class="p">[:</span><span class="n">n</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;participant_id&quot;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="s2">&quot;assignment&quot;</span><span class="p">:</span> <span class="n">assignments</span><span class="p">})</span>

<span class="n">rand_rb</span> <span class="o">=</span> <span class="n">random_block_randomization</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">block_sizes</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="n">seed</span><span class="o">=</span><span class="mi">77</span><span class="p">)</span>
<span class="n">rand_rb</span><span class="p">[</span><span class="s2">&quot;assignment&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(),</span> <span class="n">rand_rb</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
</code></pre></div>
</div>
<hr />
<h2 id="8a-python-block-randomization-with-21-allocation">8A. Python: Block randomization with 2:1 allocation<a class="headerlink" href="#8a-python-block-randomization-with-21-allocation" title="Permanent link">&para;</a></h2>
<p>Treatment:Control = 2:1<br />
A convenient block size is 6 (4 treatment, 2 control).</p>
<div class="admonition interactive">
<p class="admonition-title">Python</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="k">def</span><span class="w"> </span><span class="nf">block_randomization_ratio</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">ratio</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">block_size</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">123</span><span class="p">):</span>
    <span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>

    <span class="n">t</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">ratio</span>
    <span class="n">k</span> <span class="o">=</span> <span class="n">block_size</span> <span class="o">//</span> <span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="n">c</span><span class="p">)</span>
    <span class="n">block</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Treatment&quot;</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;Control&quot;</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">c</span><span class="o">*</span><span class="n">k</span><span class="p">)</span>

    <span class="n">assignments</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">assignments</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">:</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">block</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">rng</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
        <span class="n">assignments</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>

    <span class="n">assignments</span> <span class="o">=</span> <span class="n">assignments</span><span class="p">[:</span><span class="n">n</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;participant_id&quot;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="s2">&quot;assignment&quot;</span><span class="p">:</span> <span class="n">assignments</span><span class="p">})</span>

<span class="n">rand_21</span> <span class="o">=</span> <span class="n">block_randomization_ratio</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">ratio</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">block_size</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
<span class="n">rand_21</span><span class="p">[</span><span class="s2">&quot;assignment&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</code></pre></div>
</div>
<hr />
<h2 id="9a-python-stratified-block-randomization">9A. Python: Stratified block randomization<a class="headerlink" href="#9a-python-stratified-block-randomization" title="Permanent link">&para;</a></h2>
<p>This is common in multicenter trials:
- stratify by site
- stratify by sex
- within each stratum, block randomize with random block sizes</p>
<div class="admonition interactive">
<p class="admonition-title">Python</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">80</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;participant_id&quot;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span>
    <span class="s2">&quot;site&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="s2">&quot;SiteA&quot;</span><span class="p">,</span> <span class="s2">&quot;SiteB&quot;</span><span class="p">,</span> <span class="s2">&quot;SiteC&quot;</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="n">n</span><span class="p">),</span>
    <span class="s2">&quot;sex&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="s2">&quot;F&quot;</span><span class="p">,</span> <span class="s2">&quot;M&quot;</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="p">})</span>

<span class="k">def</span><span class="w"> </span><span class="nf">stratified_randomization</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">strata_cols</span><span class="p">,</span> <span class="n">block_sizes</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="n">seed</span><span class="o">=</span><span class="mi">123</span><span class="p">):</span>
    <span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">out</span><span class="p">[</span><span class="s2">&quot;assignment&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">out</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">strata_cols</span><span class="p">)</span><span class="o">.</span><span class="n">groups</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">m</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
        <span class="n">sub_seed</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">integers</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="o">**</span><span class="mi">9</span><span class="p">))</span>
        <span class="n">sub</span> <span class="o">=</span> <span class="n">random_block_randomization</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">block_sizes</span><span class="o">=</span><span class="n">block_sizes</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">sub_seed</span><span class="p">)</span>
        <span class="n">out</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">idx</span><span class="p">),</span> <span class="s2">&quot;assignment&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sub</span><span class="p">[</span><span class="s2">&quot;assignment&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

    <span class="k">return</span> <span class="n">out</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;participant_id&quot;</span><span class="p">)</span>

<span class="n">df_rand</span> <span class="o">=</span> <span class="n">stratified_randomization</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;site&quot;</span><span class="p">,</span> <span class="s2">&quot;sex&quot;</span><span class="p">],</span> <span class="n">block_sizes</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="n">seed</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">df_rand</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
</code></pre></div>
</div>
<p>Quick balance check:</p>
<div class="admonition interactive">
<p class="admonition-title">Python</p>
<div class="highlight"><pre><span></span><code><span class="n">balance</span> <span class="o">=</span> <span class="n">df_rand</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;site&quot;</span><span class="p">,</span> <span class="s2">&quot;sex&quot;</span><span class="p">,</span> <span class="s2">&quot;assignment&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">balance</span>
</code></pre></div>
</div>
<hr />
<h1 id="part-b-implementation-in-r">Part B — Implementation in R<a class="headerlink" href="#part-b-implementation-in-r" title="Permanent link">&para;</a></h1>
<p>R is frequently used by trial statisticians for randomization lists and audit-friendly scripts.</p>
<hr />
<h2 id="10b-r-simple-randomization-11">10B. R: Simple randomization (1:1)<a class="headerlink" href="#10b-r-simple-randomization-11" title="Permanent link">&para;</a></h2>
<div class="admonition interactive">
<p class="admonition-title">R</p>
<div class="highlight"><pre><span></span><code><span class="nf">set.seed</span><span class="p">(</span><span class="m">123</span><span class="p">)</span>

<span class="n">n</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">40</span>
<span class="n">assignment</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sample</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Treatment&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Control&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">replace</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>

<span class="n">rand_list</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span>
<span class="w">  </span><span class="n">participant_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="n">n</span><span class="p">,</span>
<span class="w">  </span><span class="n">assignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">assignment</span>
<span class="p">)</span>

<span class="nf">table</span><span class="p">(</span><span class="n">rand_list</span><span class="o">$</span><span class="n">assignment</span><span class="p">)</span>
</code></pre></div>
</div>
<hr />
<h2 id="11b-r-block-randomization-fixed-block-size">11B. R: Block randomization (fixed block size)<a class="headerlink" href="#11b-r-block-randomization-fixed-block-size" title="Permanent link">&para;</a></h2>
<div class="admonition interactive">
<p class="admonition-title">R</p>
<div class="highlight"><pre><span></span><code><span class="nf">set.seed</span><span class="p">(</span><span class="m">7</span><span class="p">)</span>

<span class="n">block_randomization</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">block_size</span><span class="o">=</span><span class="m">4</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kr">if</span><span class="w"> </span><span class="p">(</span><span class="n">block_size</span><span class="w"> </span><span class="o">%%</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="nf">stop</span><span class="p">(</span><span class="s">&quot;For 1:1 allocation, block_size must be even.&quot;</span><span class="p">)</span>

<span class="w">  </span><span class="n">assignments</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">()</span>

<span class="w">  </span><span class="kr">while</span><span class="w"> </span><span class="p">(</span><span class="nf">length</span><span class="p">(</span><span class="n">assignments</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">block</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rep</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Treatment&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Control&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">each</span><span class="o">=</span><span class="n">block_size</span><span class="o">/</span><span class="m">2</span><span class="p">)</span>
<span class="w">    </span><span class="n">block</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sample</span><span class="p">(</span><span class="n">block</span><span class="p">,</span><span class="w"> </span><span class="nf">length</span><span class="p">(</span><span class="n">block</span><span class="p">))</span>
<span class="w">    </span><span class="n">assignments</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">assignments</span><span class="p">,</span><span class="w"> </span><span class="n">block</span><span class="p">)</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="n">assignments</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">assignments</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="n">n</span><span class="p">]</span>
<span class="w">  </span><span class="nf">data.frame</span><span class="p">(</span><span class="n">participant_id</span><span class="o">=</span><span class="m">1</span><span class="o">:</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">assignment</span><span class="o">=</span><span class="n">assignments</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">rand_block</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">block_randomization</span><span class="p">(</span><span class="m">40</span><span class="p">,</span><span class="w"> </span><span class="n">block_size</span><span class="o">=</span><span class="m">4</span><span class="p">)</span>
<span class="nf">head</span><span class="p">(</span><span class="n">rand_block</span><span class="p">,</span><span class="w"> </span><span class="m">12</span><span class="p">)</span>
</code></pre></div>
</div>
<hr />
<h2 id="12b-r-random-block-sizes">12B. R: Random block sizes<a class="headerlink" href="#12b-r-random-block-sizes" title="Permanent link">&para;</a></h2>
<div class="admonition interactive">
<p class="admonition-title">R</p>
<div class="highlight"><pre><span></span><code><span class="nf">set.seed</span><span class="p">(</span><span class="m">77</span><span class="p">)</span>

<span class="n">random_block_randomization</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">block_sizes</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">4</span><span class="p">,</span><span class="m">6</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">assignments</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">()</span>

<span class="w">  </span><span class="kr">while</span><span class="w"> </span><span class="p">(</span><span class="nf">length</span><span class="p">(</span><span class="n">assignments</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">b</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sample</span><span class="p">(</span><span class="n">block_sizes</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">)</span>
<span class="w">    </span><span class="kr">if</span><span class="w"> </span><span class="p">(</span><span class="n">b</span><span class="w"> </span><span class="o">%%</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="kr">next</span>

<span class="w">    </span><span class="n">block</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rep</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Treatment&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Control&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">each</span><span class="o">=</span><span class="n">b</span><span class="o">/</span><span class="m">2</span><span class="p">)</span>
<span class="w">    </span><span class="n">block</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sample</span><span class="p">(</span><span class="n">block</span><span class="p">,</span><span class="w"> </span><span class="nf">length</span><span class="p">(</span><span class="n">block</span><span class="p">))</span>
<span class="w">    </span><span class="n">assignments</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">assignments</span><span class="p">,</span><span class="w"> </span><span class="n">block</span><span class="p">)</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="n">assignments</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">assignments</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="n">n</span><span class="p">]</span>
<span class="w">  </span><span class="nf">data.frame</span><span class="p">(</span><span class="n">participant_id</span><span class="o">=</span><span class="m">1</span><span class="o">:</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">assignment</span><span class="o">=</span><span class="n">assignments</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">rand_rb</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">random_block_randomization</span><span class="p">(</span><span class="m">40</span><span class="p">,</span><span class="w"> </span><span class="n">block_sizes</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">4</span><span class="p">,</span><span class="m">6</span><span class="p">))</span>
<span class="nf">table</span><span class="p">(</span><span class="n">rand_rb</span><span class="o">$</span><span class="n">assignment</span><span class="p">)</span>
</code></pre></div>
</div>
<hr />
<h2 id="13b-r-21-allocation-with-blocks">13B. R: 2:1 allocation with blocks<a class="headerlink" href="#13b-r-21-allocation-with-blocks" title="Permanent link">&para;</a></h2>
<p>For ratio 2:1, a block size of 6 gives:
- 4 Treatment
- 2 Control</p>
<div class="admonition interactive">
<p class="admonition-title">R</p>
<div class="highlight"><pre><span></span><code><span class="nf">set.seed</span><span class="p">(</span><span class="m">9</span><span class="p">)</span>

<span class="n">block_randomization_ratio</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">ratio</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">block_size</span><span class="o">=</span><span class="m">6</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">t</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ratio</span><span class="p">[</span><span class="m">1</span><span class="p">]</span>
<span class="w">  </span><span class="n">c</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ratio</span><span class="p">[</span><span class="m">2</span><span class="p">]</span>
<span class="w">  </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">block_size</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">t</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c</span><span class="p">)</span>
<span class="w">  </span><span class="kr">if</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nf">floor</span><span class="p">(</span><span class="n">k</span><span class="p">))</span><span class="w"> </span><span class="nf">stop</span><span class="p">(</span><span class="s">&quot;Choose a block_size divisible by sum(ratio).&quot;</span><span class="p">)</span>

<span class="w">  </span><span class="n">block</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="s">&quot;Treatment&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="o">*</span><span class="n">k</span><span class="p">),</span><span class="w"> </span><span class="nf">rep</span><span class="p">(</span><span class="s">&quot;Control&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="o">*</span><span class="n">k</span><span class="p">))</span>

<span class="w">  </span><span class="n">assignments</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">()</span>
<span class="w">  </span><span class="kr">while</span><span class="w"> </span><span class="p">(</span><span class="nf">length</span><span class="p">(</span><span class="n">assignments</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">b</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sample</span><span class="p">(</span><span class="n">block</span><span class="p">,</span><span class="w"> </span><span class="nf">length</span><span class="p">(</span><span class="n">block</span><span class="p">))</span>
<span class="w">    </span><span class="n">assignments</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">assignments</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">)</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="n">assignments</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">assignments</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="n">n</span><span class="p">]</span>
<span class="w">  </span><span class="nf">data.frame</span><span class="p">(</span><span class="n">participant_id</span><span class="o">=</span><span class="m">1</span><span class="o">:</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">assignment</span><span class="o">=</span><span class="n">assignments</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">rand_21</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">block_randomization_ratio</span><span class="p">(</span><span class="m">60</span><span class="p">,</span><span class="w"> </span><span class="n">ratio</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">block_size</span><span class="o">=</span><span class="m">6</span><span class="p">)</span>
<span class="nf">table</span><span class="p">(</span><span class="n">rand_21</span><span class="o">$</span><span class="n">assignment</span><span class="p">)</span>
</code></pre></div>
</div>
<hr />
<h2 id="14b-r-stratified-block-randomization-by-site-and-sex">14B. R: Stratified block randomization (by site and sex)<a class="headerlink" href="#14b-r-stratified-block-randomization-by-site-and-sex" title="Permanent link">&para;</a></h2>
<div class="admonition interactive">
<p class="admonition-title">R</p>
<div class="highlight"><pre><span></span><code><span class="nf">set.seed</span><span class="p">(</span><span class="m">10</span><span class="p">)</span>

<span class="n">n</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">80</span>
<span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span>
<span class="w">  </span><span class="n">participant_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="n">n</span><span class="p">,</span>
<span class="w">  </span><span class="n">site</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sample</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;SiteA&quot;</span><span class="p">,</span><span class="s">&quot;SiteB&quot;</span><span class="p">,</span><span class="s">&quot;SiteC&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">replace</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">),</span>
<span class="w">  </span><span class="n">sex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sample</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;F&quot;</span><span class="p">,</span><span class="s">&quot;M&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">replace</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">stratified_randomization</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="n">strata_cols</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;site&quot;</span><span class="p">,</span><span class="s">&quot;sex&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">block_sizes</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">4</span><span class="p">,</span><span class="m">6</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">out</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df</span>
<span class="w">  </span><span class="n">out</span><span class="o">$</span><span class="n">assignment</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kc">NA</span>

<span class="w">  </span><span class="n">strata_key</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">interaction</span><span class="p">(</span><span class="n">out</span><span class="p">[,</span><span class="w"> </span><span class="n">strata_cols</span><span class="p">],</span><span class="w"> </span><span class="n">drop</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>

<span class="w">  </span><span class="kr">for</span><span class="w"> </span><span class="p">(</span><span class="n">s</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="nf">levels</span><span class="p">(</span><span class="n">strata_key</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">idx</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">which</span><span class="p">(</span><span class="n">strata_key</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">s</span><span class="p">)</span>
<span class="w">    </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">length</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>

<span class="w">    </span><span class="n">a</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">random_block_randomization</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">block_sizes</span><span class="o">=</span><span class="n">block_sizes</span><span class="p">)</span><span class="o">$</span><span class="n">assignment</span>
<span class="w">    </span><span class="n">out</span><span class="o">$</span><span class="n">assignment</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">a</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="n">out</span><span class="p">[</span><span class="nf">order</span><span class="p">(</span><span class="n">out</span><span class="o">$</span><span class="n">participant_id</span><span class="p">),</span><span class="w"> </span><span class="p">]</span>
<span class="p">}</span>

<span class="n">df_rand</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">stratified_randomization</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="n">strata_cols</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;site&quot;</span><span class="p">,</span><span class="s">&quot;sex&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">block_sizes</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">4</span><span class="p">,</span><span class="m">6</span><span class="p">))</span>
<span class="nf">head</span><span class="p">(</span><span class="n">df_rand</span><span class="p">,</span><span class="w"> </span><span class="m">12</span><span class="p">)</span>
</code></pre></div>
</div>
<p>Balance check:</p>
<div class="admonition interactive">
<p class="admonition-title">R</p>
<div class="highlight"><pre><span></span><code><span class="nf">with</span><span class="p">(</span><span class="n">df_rand</span><span class="p">,</span><span class="w"> </span><span class="nf">table</span><span class="p">(</span><span class="n">site</span><span class="p">,</span><span class="w"> </span><span class="n">sex</span><span class="p">,</span><span class="w"> </span><span class="n">assignment</span><span class="p">))</span>
</code></pre></div>
</div>
<hr />
<h2 id="15-practical-notes-for-real-trial-implementation">15. Practical notes for real trial implementation<a class="headerlink" href="#15-practical-notes-for-real-trial-implementation" title="Permanent link">&para;</a></h2>
<h3 id="151-dont-treat-a-simple-script-as-the-full-randomization-system">15.1 Don’t treat a simple script as the full randomization system<a class="headerlink" href="#151-dont-treat-a-simple-script-as-the-full-randomization-system" title="Permanent link">&para;</a></h3>
<p>In real regulated trials:
- randomization must be auditable
- list generation must be documented
- access to the list must be restricted
- concealment must be guaranteed operationally</p>
<p>A script is typically used to generate a list that is then implemented via:
- IRT/EDC system
- pharmacy
- central randomization service</p>
<h3 id="152-document-decisions-clearly">15.2 Document decisions clearly<a class="headerlink" href="#152-document-decisions-clearly" title="Permanent link">&para;</a></h3>
<p>Include in the protocol/SAP:
- allocation ratio
- method (simple/block/stratified)
- block size policy (random sizes recommended)
- stratification factors
- who generates the list and who has access</p>
<hr />
<h2 id="16-exercises">16. Exercises<a class="headerlink" href="#16-exercises" title="Permanent link">&para;</a></h2>
<details>
<summary>Click to try the exercises</summary>

1. Use Python or R to generate a randomization list for n=120 with 1:1 allocation using random block sizes (4 and 6).  
2. Repeat the generation 100 times and record how often Treatment count differs from Control by more than 10 participants (simple randomization vs block randomization).  
3. Create stratified randomization by site only and compare within-site imbalance to non-stratified randomization.  
4. Write a short paragraph describing your randomization and concealment approach as if for a protocol.  
5. Explain why fixed block size can create predictability and how random block sizes help.

</details>

<hr />
<h2 id="17-summary">17. Summary<a class="headerlink" href="#17-summary" title="Permanent link">&para;</a></h2>
<p>Randomization protects treatment comparisons from confounding, but proper implementation matters:
- simple randomization is unpredictable but can be imbalanced in small trials
- block randomization improves balance but can be predictable if poorly implemented
- stratified randomization improves balance on important prognostic factors
- allocation concealment prevents selection bias and is essential even if blinding is not possible
- baseline p-values are discouraged; use descriptive baseline tables instead</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.sections", "navigation.expand", "navigation.indexes", "navigation.prune", "navigation.top", "toc.follow", "search.highlight", "search.suggest"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>